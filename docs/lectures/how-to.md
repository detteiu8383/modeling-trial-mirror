# 3DCGはどう作るの？

3DCG制作の具体的な手順について学んでいく。

一般的な3DCG制作では大体下のような流れ。

1. [立体物を用意する](#_1-立体物を用意する)
2. [立体物を動かす](#_2-立体物を動かす)
3. [カメラやライト等の準備](#_3-カメラやライト等の準備)
4. [画像に変換する](#_4-画像に変換する)
5. [エフェクト等で調整](#_5-エフェクト等で調整)

## 1. 立体物を用意する

> コンピュータの演算によって3次元空間内の仮想的な立体物を2次元である平面上の情報に変換することで奥行き感（立体感）のある**画像を作る手法**<br>
> (引用<https://ja.wikipedia.org/wiki/3%E6%AC%A1%E5%85%83%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3%E3%83%83%E3%82%AF%E3%82%B9>)

この定義における"3次元空間内の仮想的な立体物"のことを一般的に**3Dモデル**(3D model)と呼ぶ。
3Dモデルを作る過程を**モデリング**(modeling)と呼ぶ。

:::tip
本来"モデリング"と言う時は"立体物の作成過程"のみを指す。Vtuber等の流行で"モデリング"という単語が独り歩きしてる感あるけどモデリングは3DCGのほんの一部に過ぎない。
:::

3Dモデルの構成要素は大きく分けて**ポリゴンメッシュ**と**マテリアル**の二つ。

### ポリゴンメッシュ

3Dモデルの**形**は**ポリゴンメッシュ**(polygon mesh)で...つまり**多角形**の**網目**で表現される。
ポリゴンメッシュはさらに以下の3つの要素で構成される。

- **頂点**(Vertex)
  - 位置のデータ(3次元)を持つ点
- **辺**(Edge)
  - 2つの頂点間を結んだ線
- **面**(Face)
  - 3つ以上の辺で囲まれた多角形

![頂点・辺・面の例](/modeling-trial/images/how-to/polygonmesh_compornents.png)

下図の黒い点が**頂点**、黒い線が**辺**、白い部分は**面**。

![実際の3Dモデルにおける頂点・辺・面の例](/modeling-trial/images/how-to/polygonmesh_sample.png)

このように頂点や面を追加したり、
位置を調整してポリゴンメッシュを作るのが
モデリングの第一段階。

### マテリアル

3Dモデルの**材質**は**マテリアル**(material)によって規定されている。

マテリアルは、**材質に関する設定**をまとめたもの。

- **色**(アルベド/ベースカラー)
  - どんな光を反射するか?
- 表面の粗さ(ラフネス/スムースネス)
  - ざらざらか？つるつるか？
- 金属っぽさ(メタリック)

などの**描画に必要な情報**<small>(と、
**シェーダー**)</small>を内包している。

:::details シェーダーについて
**シェーダー**は各設定値を元に**描画色を計算するスクリプト**。今回の体験会ではシェーダーについては深く触れないが、

「"色(0.0, 0.9, 0.9), 粗さ0.5, メタリック0"という設定で、白い光がこっちの方から当たっているから反射を計算して...このピクセルの色は"(0.5, 1.0, 1.0)"だ！」

みたいな計算をしている。シェーダーについて詳しい話をしようとするとそれだけで講習会が5個ぐらい必要になるので、より詳しい話を知りたい方はググってください...

シェーダーは**がっつりプログラミング**の領域なので、「お絵描きはできないけどプログラミングできるのでこれで芸術作品作る」みたいな人もいっぱいいる → "[#つぶやきGLSL](https://twitter.com/search?q=%23%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8DGLSL&src=typed_query)"などでググるとおもしろい

ググりワード：シェーダー, 頂点シェーダ―, フラグメントシェーダー, GLSL
:::

下図はそれぞれ異なる設定を与えたマテリアルを、同じ球体の3Dモデルに適用した例。設定した値によって見た目が変化しているのがわかる。

![異なるマテリアルを適用した球の画像](/modeling-trial/images/how-to/material_sample.png)

## 2. 立体物を動かす

映像を作成する場合は、3Dモデルの位置や形状を時間に応じて変化させる(**アニメーション**させる)必要がある。

アニメーションの設定では主に**キーフレームアニメーション**と**スケルタルアニメーション**いう仕組みを用いる。

### フレーム

ここでは下図の様な、ボールを下方に移動させるアニメーションを作る場合を考える。

![ボールが移動するアニメーション](/modeling-trial/images/how-to/animation.gif)

このようなアニメーションを作成する場合、ボールの位置**少しずつずらした**複数の画像を用意し、これらを**素早く切り替えて表示する**ことで動いているように見せる。パラパラ漫画と同じ原理。

![ボールが移動するアニメーションの各フレーム](/modeling-trial/images/how-to/animation_frames.png)

この1枚1枚の画像を**フレーム**と呼ぶ。

例えばTVアニメは1秒間に24枚の画像を素早く切り替えて表示することで動いているように見せている。これを"24fps(frame per second = フレーム毎秒)のアニメーション"と呼んだりする。

3DCGでもアニメと同様に、複数の画像を素早く切り替えることで動きを表現する。

しかし、すべてのフレームで3Dモデルの位置を設定するのはとても大変。30秒・24fpsの動画を作るだけでも30×24=720枚もの画像を作る必要があり、全てを手動で作成するのはめんどくさい。そこで、キーフレームアニメーションと呼ばれる手法を利用する。

### キーフレームアニメーション

**キーフレームアニメーション**は、

### スケルタルアニメーション

## 3. カメラやライト等の準備

## 4. 画像に変換する

## 5. エフェクト等で調整
