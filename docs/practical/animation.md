# アニメーションの作成

ここまでで、"立体物の用意"は完了しました。次に、このモデルを動かせるようにしていきましょう。

:::training

## スケルトンの追加

まず、モデルを動かすための骨格である、スケルトンの追加を行います。

**オブジェクトモードに戻り**、"追加"→"**アーマチュア**"を選択してください(Blenderではスケルトンのことをアーマチュアと呼びます)。

![](https://md.trap.jp/uploads/upload_6586a2c9b5025b4b350d7d0288022288.png)

![](https://md.trap.jp/uploads/upload_97049b039dfa7fae199efbbe0de14c9e.png)

座学スライドで見せたような"ボーン"が追加されました。

このままではメッシュに隠れて見づらいので、ボーンが常に最前面に表示されるよう設定します。オブジェクトモードで追加したアーマチュアを選択し、プロパティパネルの棒人間マークを選択してください。これがアーマチュアの設定パネルです。この中の"ビューポート表示"の"最前面"にチェックを入れてください。すると、ボーンが常に最前面に表示されるようになります。

![](./imgs/2022-04-29-12-19-48.png)

アーマチュアを選択して、アーマチュアの**編集モードに切り替え**ましょう。メッシュの編集モードと同様に、ボーンを操作することができます。下図のように、体の中心にボーンを移動させてください。

![](https://md.trap.jp/uploads/upload_5ffea20f5c7395a93165c48e3ea51583.png)

![](https://md.trap.jp/uploads/upload_66b73ac0cb288e6238b246dbb810d1c8.png)

さらに、手足や頭の変形のためにボーンを追加します。アーマチュアの編集モードになっていることを確認し、体中央のボーンの先端のジョイント(球の部分)を選択してください。

この状態で左のツール一覧から**押し出し**ツールを選択します。

![](https://md.trap.jp/uploads/upload_20298792295e30e4850f5a6837fee0df.png)

すると、メッシュの編集時の押し出しツールと同じマニピュレータが出てきます。

![](https://md.trap.jp/uploads/upload_dc16bda2d56763b3f10d69cf17f7b5aa.png)

メッシュの時と同様に、白い円をドラッグすることで新たなボーンを作成することができます。これを使って、まず背骨先端から肩に向かって伸びるボーンを作成しましょう。

![](./imgs/2022-04-29-12-38-35.png)

次に、肩からボーンを押し出して、腕の中心をとおる位置にボーンを追加しましょう。

![](./imgs/2022-04-29-12-39-19.png)

これを繰り返し、体中心のボーンから押し出して作ったボーンで両手足と頭の位置にボーンを設置してください。

![](./imgs/2022-04-29-12-40-56.png)

↑こんな感じになっていればOK

## スキンウェイトの設定

次に、スキンウェイトの設定を行います。今回は自動でウェイト調整してくれる機能を用います。

まずオブジェクトモードに戻り、モデルのメッシュだけを選択してください。

![](./imgs/2022-04-29-12-41-24.png)

次に、**メッシュを選択したまま**、<kbd>shift</kbd>+左クリックでアーマチュアも選択してください。下図のようにアーマチュアがオレンジ、メッシュが濃いオレンジになっていればOK。

![](./imgs/2022-04-29-12-41-48.png)

この状態で左上のメニューから"オブジェクト"→"ペアレント"→"自動のウェイトで"を選択してください。これにより、メッシュがアーマチュアに追従する用設定されます。

![](./imgs/2022-04-29-12-45-21.png)

## ポーズ作成

モデルとアーマチュアを結びつけることができたので、次にポーズを設定します。
オブジェクトモードで**アーマチュアを選択し**、**ポーズモード**に切り替えます。

![](./imgs/2022-04-29-12-47-34.png)

この状態でボーンの移動や回転をすると、モデルを変形させることができます。

![](./imgs/posing_optimize.gif)

![](./imgs/2022-04-29-12-49-15.png)

変形をリセットしたい場合、リセットしたいボーンを選択した状態で"ポーズ"→"トランスフォームをクリア"から、位置や回転をリセットすることができます。

![](./imgs/2022-04-29-12-51-15.png)

## キーフレームの作成

ここからは、実際にアニメーションを作成していきます。

まず、キーフレームを作成するために**タイムライン**パネルを広げます。タイムラインパネルは画面下部に存在します。ビューポートとの境界線にマウスを重ね、矢印が出たらドラッグして領域を広げることができます。

![](https://md.trap.jp/uploads/upload_3a69be7e8ab1f7a1ba34f317acf028b3.png)

![](https://md.trap.jp/uploads/upload_b8042804302dbc78106f6d2f8b4083a8.png)

これでキーフレームを作成する準備ができました。
まず、**タイムラインの青いバーを0フレーム目に合わせてください**。

![](./imgs/2022-04-29-12-55-54.png)

これが「今から0フレーム目を編集するよ」という印です。

**この状態で**アーマチュアの**ポーズモード**に移り、自由にポーズを作ってください。

ポーズができたらボーンを**全選択**(<kbd>A</kbd>)し、左上のメニューから"ポーズ"→"アニメーション"→"キーフレームを挿入..."を選択して**キーフレームの挿入**を行います。  
(ショートカットキーとして、**<kbd>I</kbd>を押してキーフレームの挿入**を行うこともできます。)

![](./imgs/2022-04-29-13-00-21.png)

キーフレームの挿入を選択すると、"キーフレーム挿入メニュー"というメニューが表示されます。これは、選択したアイテムのどの要素をキーフレームとして登録するかを選ぶメニューです。

![](./imgs/2022-04-29-13-18-38.png)

メニューの"位置・回転・スケール"を選択すると、選択したボーンの位置・回転・スケールがキーフレームとして0フレーム目に挿入されます。

キーフレームが挿入された印として、タイムラインに黄色のひし形が表示されます。

![](https://md.trap.jp/uploads/upload_c33302dd21f3660a7c3f0576d9b99185.png)

タイムラインのバーを動かして別のフレームに移動→そのフレームでのポーズを設定→...
を繰り返すことでアニメーションを作成していきます。自分の好きなフレームで、好きなポーズをキーフレームとして設定してみましょう。

## アニメーションの長さの設定

プロパティパネルの**出力プロパティ**で、出力の設定をすることができます。プリンターのようなアイコンで示されています。

アニメーションの秒数は、"フレーム範囲"内の終了フレームの指定により変更できます。1秒間に24フレーム用いるので、5秒の動画にしたい場合は24×5=120フレームに設定してください。今回私は1秒間の短いループ動画にしたいので、終了を24に設定しました。

![](./imgs/2022-04-29-13-25-42.png)

例えば、0フレーム目で片腕を上げ、12フレーム目で腕を下げ、24フレーム目にまた腕を上げるポーズを取らせる(3つのキーフレームを挿入する)ことで、手を振るアニメーションができます。

![](./imgs/swing_optimize.gif)

![](./imgs/2022-04-29-13-31-58.png)

:::
